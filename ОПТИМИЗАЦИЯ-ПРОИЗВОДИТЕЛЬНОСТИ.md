# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

## üìä –¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω Render PostgreSQL:
- **–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–Ω–ª–∞–π–Ω:** 50-100 –∏–≥—Ä–æ–∫–æ–≤
- **–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 10,000-50,000
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–π:** ~20-25
- **RAM:** 256 MB
- **Storage:** 1 GB

## üéØ –°–ø–æ—Å–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Connection Pool (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

–í `server/db-dual.js` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω connection pooling:
```javascript
connectionLimit: 10  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
```

### 2. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `server/cache.js`:

```javascript
// –ü—Ä–æ—Å—Ç–æ–π –∫—ç—à –≤ –ø–∞–º—è—Ç–∏
const cache = new Map()
const CACHE_TTL = 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç

export function getCached(key) {
  const item = cache.get(key)
  if (!item) return null
  
  if (Date.now() > item.expires) {
    cache.delete(key)
    return null
  }
  
  return item.value
}

export function setCache(key, value, ttl = CACHE_TTL) {
  cache.set(key, {
    value,
    expires: Date.now() + ttl
  })
}

export function clearCache(key) {
  if (key) {
    cache.delete(key)
  } else {
    cache.clear()
  }
}
```

### 3. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏—Ü–µ–Ω–∑–∏–π

–í `server/index.js` –¥–æ–±–∞–≤—å—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:

```javascript
import { getCached, setCache } from './cache.js'

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ —Å –∫—ç—à–µ–º
async function checkSubscription(userId) {
  const cacheKey = `sub_${userId}`
  const cached = getCached(cacheKey)
  if (cached) return cached
  
  const [users] = await pool.query('SELECT * FROM users WHERE id = ?', [userId])
  const result = isSubscriptionActive(users[0])
  
  setCache(cacheKey, result, 60000) // –ö—ç—à –Ω–∞ 1 –º–∏–Ω—É—Ç—É
  return result
}
```

### 4. –ò–Ω–¥–µ–∫—Å—ã (—É–∂–µ —Å–æ–∑–¥–∞–Ω—ã)

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã:
```sql
-- –£–∂–µ –µ—Å—Ç—å –≤ db-dual.js
CREATE INDEX idx_users_uid ON users(uid);
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);
```

### 5. –û—Ç–∫–ª—é—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–í `.env` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```env
SYNC_DATABASES=false  # –£—Å–∫–æ—Ä–∏—Ç –∑–∞–ø—Ä–æ—Å—ã
```

### 6. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MySQL –∫–∞–∫ –≥–ª–∞–≤–Ω—É—é –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–í `.env`:
```env
PRIMARY_DB=mysql  # –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î –±—ã—Å—Ç—Ä–µ–µ
```

## üìà –ü–ª–∞–Ω—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ 100 –∏–≥—Ä–æ–∫–æ–≤ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- ‚úÖ –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ Connection pooling
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### 100-500 –∏–≥—Ä–æ–∫–æ–≤ ($7/–º–µ—Å—è—Ü)
**Render Standard:**
- 60 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- 512 MB RAM
- 10 GB Storage

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 500-2000 –∏–≥—Ä–æ–∫–æ–≤ ($20/–º–µ—Å—è—Ü)
**Render Pro:**
- 120 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- 1 GB RAM
- 50 GB Storage

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- Read replicas
- Load balancer
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 2000+ –∏–≥—Ä–æ–∫–æ–≤ ($50+/–º–µ—Å—è—Ü)
**Render Enterprise –∏–ª–∏ AWS/GCP:**
- –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏

### –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `monitor-performance.js`:

```javascript
import dotenv from 'dotenv'
dotenv.config()

import { pgPool, mysqlPool } from './server/db-dual.js'

async function monitorPerformance() {
  console.log('üìä Performance Monitor\n')
  
  if (pgPool) {
    console.log('PostgreSQL (Render):')
    console.log(`  Total connections: ${pgPool.totalCount}`)
    console.log(`  Idle connections: ${pgPool.idleCount}`)
    console.log(`  Waiting requests: ${pgPool.waitingCount}`)
  }
  
  if (mysqlPool) {
    console.log('\nMySQL (XAMPP):')
    const [status] = await mysqlPool.query('SHOW STATUS LIKE "Threads_connected"')
    console.log(`  Active connections: ${status[0].Value}`)
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
  if (pgPool) {
    const result = await pgPool.query(`
      SELECT pg_size_pretty(pg_database_size(current_database())) as size
    `)
    console.log(`\nDatabase size: ${result.rows[0].size}`)
  }
}

setInterval(monitorPerformance, 10000) // –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
```

–ó–∞–ø—É—Å–∫:
```bash
node monitor-performance.js
```

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –£–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø—Ä–æ–≤–µ—Ä–æ–∫

–í–º–µ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ:
```javascript
// –ü–ª–æ—Ö–æ: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑
app.get('/api/download', requireAuth, async (req, res) => {
  const [users] = await pool.query('SELECT * FROM users WHERE id = ?', [req.user.id])
  if (!isSubscriptionActive(users[0])) return res.status(403).json({error: 'no_sub'})
  // ...
})

// –•–æ—Ä–æ—à–æ: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ç–æ–∫–µ–Ω–µ
app.get('/api/download', requireAuth, async (req, res) => {
  if (!req.user.hasSubscription) return res.status(403).json({error: 'no_sub'})
  // –ù–µ—Ç –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î!
})
```

### 2. –ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤

–í–º–µ—Å—Ç–æ N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–µ–ª–∞—Ç—å 1:
```javascript
// –ü–ª–æ—Ö–æ: N –∑–∞–ø—Ä–æ—Å–æ–≤
for (const userId of userIds) {
  const [user] = await pool.query('SELECT * FROM users WHERE id = ?', [userId])
}

// –•–æ—Ä–æ—à–æ: 1 –∑–∞–ø—Ä–æ—Å
const [users] = await pool.query('SELECT * FROM users WHERE id IN (?)', [userIds])
```

### 3. –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

–ù–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É:
```javascript
// –ü–ª–æ—Ö–æ: –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
const [users] = await pool.query('SELECT * FROM users')

// –•–æ—Ä–æ—à–æ: –ø–∞–≥–∏–Ω–∞—Ü–∏—è
const [users] = await pool.query('SELECT * FROM users LIMIT 50 OFFSET ?', [offset])
```

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Apache Bench:
```bash
# Windows (—á–µ—Ä–µ–∑ Chocolatey)
choco install apache-httpd

# –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å apache.org
```

### –¢–µ—Å—Ç –Ω–∞–≥—Ä—É–∑–∫–∏:
```bash
# 100 –∑–∞–ø—Ä–æ—Å–æ–≤, 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
ab -n 100 -c 10 http://localhost:5173/api/health

# –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∂–µ—Ç:
# - Requests per second (RPS)
# - Time per request
# - Failed requests
```

## üéØ –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

### –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **Response time:** < 100ms
- **Throughput:** > 100 RPS
- **Error rate:** < 1%
- **CPU usage:** < 70%
- **Memory usage:** < 80%

### –ö–æ–≥–¥–∞ –ø–æ—Ä–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è:
- ‚ùå Response time > 500ms
- ‚ùå Error rate > 5%
- ‚ùå CPU usage > 90%
- ‚ùå Memory usage > 90%
- ‚ùå –ß–∞—Å—Ç—ã–µ —Ç–∞–π–º–∞—É—Ç—ã

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ç–µ–∫—É—â–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (< 100 –∏–≥—Ä–æ–∫–æ–≤):
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
2. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ –±–∞–∑–æ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–∏ —Ä–æ—Å—Ç–µ –¥–æ 100-500 –∏–≥—Ä–æ–∫–æ–≤:
1. üí∞ Upgrade Render –¥–æ Standard ($7/–º–µ—Å)
2. üöÄ –î–æ–±–∞–≤—å—Ç–µ Redis –¥–ª—è –∫—ç—à–∞
3. üìä –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–∏ —Ä–æ—Å—Ç–µ –¥–æ 500+ –∏–≥—Ä–æ–∫–æ–≤:
1. üí∞ Upgrade Render –¥–æ Pro ($20/–º–µ—Å)
2. üöÄ –î–æ–±–∞–≤—å—Ç–µ CDN (Cloudflare)
3. üîÑ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ read replicas
4. üìä –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
node monitor-performance.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
npm run check:db

# –¢–µ—Å—Ç –Ω–∞–≥—Ä—É–∑–∫–∏
ab -n 1000 -c 50 http://localhost:5173/api/health
```

## üìà –ü—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞

| –ò–≥—Ä–æ–∫–æ–≤ | –ü–ª–∞–Ω | –¶–µ–Ω–∞ | –ß—Ç–æ –Ω—É–∂–Ω–æ |
|---------|------|------|-----------|
| 0-100 | Free | $0 | –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| 100-500 | Standard | $7 | Upgrade Render |
| 500-2000 | Pro | $20 | + Redis, CDN |
| 2000-10000 | Enterprise | $50+ | + Load balancer |
| 10000+ | Custom | $200+ | Dedicated servers |

## ‚úÖ –ò—Ç–æ–≥–æ

**–°–µ–π—á–∞—Å –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Ç—è–Ω–µ—Ç:**
- ‚úÖ 50-100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–Ω–ª–∞–π–Ω
- ‚úÖ 10,000-50,000 –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ!

**–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:**
- üìà –õ–µ–≥–∫–æ upgrade –Ω–∞ Render
- üí∞ –û—Ç $7/–º–µ—Å—è—Ü –¥–ª—è 500 –∏–≥—Ä–æ–∫–æ–≤
- üöÄ –ì–æ—Ç–æ–≤–∞ –∫ —Ä–æ—Å—Ç—É
