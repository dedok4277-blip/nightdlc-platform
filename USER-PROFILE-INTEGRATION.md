# Интеграция профиля пользователя в ClickGUI

## Что было добавлено

### 1. Серверная часть (API)

Добавлен публичный эндпоинт для получения данных пользователя:

**Эндпоинт:** `GET /api/user/:uid`

**Пример запроса:**
```
GET https://nelondlc.onrender.com/api/user/12345
```

**Пример ответа:**
```json
{
  "username": "Wh1teW1ndows_",
  "uid": "12345",
  "isAdmin": true,
  "avatarUrl": "https://nelondlc.onrender.com/uploads/avatar.png"
}
```

### 2. Клиентская часть (Minecraft)

#### Класс WebsiteAPI
Уже существующий класс `dev.wh1tew1ndows.client.api.WebsiteAPI` автоматически загружает данные пользователя при запуске клиента.

**Методы:**
- `loadUserData(String uid)` - загружает данные пользователя с сервера
- `getUsername()` - возвращает никнейм пользователя
- `isAdmin()` - проверяет, является ли пользователь администратором
- `getAvatarTexture()` - возвращает текстуру аватарки
- `isLoaded()` - проверяет, загружены ли данные

#### Отображение в ClickGUI

В классе `Panel.java` добавлен метод `renderUserProfile()`, который:
- Отображает аватарку пользователя (32x32 пикселя, округленная)
- Показывает никнейм пользователя
- Располагается в левом нижнем углу ClickGUI
- Автоматически обрезает длинные никнеймы

**Расположение:** Левый нижний угол окна ClickGUI, над полем поиска

## Как это работает

1. При запуске клиента в `NightDLC.java` вызывается `WebsiteAPI.loadUserData(uid)`
2. WebsiteAPI отправляет запрос к API сервера
3. Данные загружаются асинхронно в фоновом потоке
4. Аватарка загружается и конвертируется в текстуру Minecraft
5. При открытии ClickGUI отображается профиль пользователя

## Тестирование

### Тест API
```bash
node test-user-api.js
```

### Тест в клиенте
1. Запустите сервер: `npm run dev`
2. Запустите Minecraft клиент
3. Откройте ClickGUI (обычно клавиша RightShift)
4. В левом нижнем углу должен отображаться профиль

## Требования к аватаркам

- **Формат:** PNG, JPG, GIF
- **Размер файла:** до 2MB
- **Рекомендуемое разрешение:** 128x128 или 256x256 пикселей
- **Форма:** квадратная (автоматически округляется в GUI)

## Загрузка аватарки

Пользователи могут загрузить аватарку через веб-интерфейс:
1. Войти в аккаунт на сайте
2. Перейти в настройки профиля
3. Загрузить изображение
4. Аватарка автоматически сохранится в базе данных

## Безопасность

- API использует HTTPS для защиты данных
- Таймаут подключения: 5 секунд
- Таймаут чтения: 5 секунд
- При ошибке загрузки используются данные по умолчанию
- Публичный эндпоинт не требует авторизации (только чтение)

## Fallback поведение

Если данные не загрузились:
- Отображается никнейм из локального профиля
- Вместо аватарки показывается иконка пользователя
- Клиент продолжает работать нормально

## Файлы изменений

### Клиент (NightDLC)
- `src/java/dev/wh1tew1ndows/client/screen/clickgui/component/Panel.java` - добавлен метод `renderUserProfile()`
- `src/java/dev/wh1tew1ndows/client/api/WebsiteAPI.java` - уже существовал

### Сервер (Site For NightDLC)
- `server/index.js` - добавлен эндпоинт `GET /api/user/:uid`
- `test-user-api.js` - тестовый скрипт

## Дополнительные возможности

В будущем можно добавить:
- Отображение статуса подписки
- Индикатор администратора (корона, значок)
- Анимацию при наведении
- Клик для открытия профиля
- Отображение онлайн статуса
